TODO: Reimplement to support multiple cursors