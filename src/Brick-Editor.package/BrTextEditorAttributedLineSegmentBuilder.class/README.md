I am smarter segment line-based builder with support of various structural attributes. See the list of supported attributes below.

Note: I  support embedded elements though special attribute